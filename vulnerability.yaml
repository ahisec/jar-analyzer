!!me.n1ar4.jar.analyzer.gui.vul.Rule
name: jar-analyzer-vulnerability-rule
vulnerabilities:
  JNDI:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: javax/naming/Context
      methodName: lookup
      methodDesc: (Ljava/lang/String;)Ljava/lang/Object;
      level: high
  Runtime.exec:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: java/lang/Runtime
      methodName: exec
      methodDesc: null
      level: high
  ProcessBuilder.start:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: java/lang/ProcessBuilder
      methodName: start
      methodDesc: ()Ljava/lang/Process;
      level: high
  SpEL.getValue:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: org/springframework/expression/Expression
      methodName: getValue
      methodDesc: null
      level: high
  readObject:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: java/io/ObjectInputStream
      methodName: readObject
      methodDesc: ()Ljava/lang/Object;
      level: high
  ScriptEngine.eval:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: javax/script/ScriptEngine
      methodName: eval
      methodDesc: (Ljava/lang/String;)Ljava/lang/Object;
      level: high
  BCEL.loadClass:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: com/sun/org/apache/bcel/internal/util/ClassLoader
      methodName: loadClass
      methodDesc: (Ljava/lang/String;)Ljava/lang/Class;
      level: medium
  defineClass:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: null
      methodName: defineClass
      methodDesc: (Ljava/lang/String;[BII)Ljava/lang/Class;
      level: medium
  OGNL.getValue:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: ognl/Ognl
      methodName: getValue
      methodDesc: null
      level: high
  Fastjson:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: com/alibaba/fastjson/JSON
      methodName: parse
      methodDesc: null
      level: high
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: com/alibaba/fastjson/JSON
      methodName: parseObject
      methodDesc: null
      level: high
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: com/alibaba/fastjson/JSONObject
      methodName: parse
      methodDesc: null
      level: high
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: com/alibaba/fastjson/JSONObject
      methodName: parseObject
      methodDesc: null
      level: high
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: com/alibaba/fastjson/JSONArray
      methodName: parse
      methodDesc: null
      level: high
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: com/alibaba/fastjson/JSONArray
      methodName: parseObject
      methodDesc: null
      level: high
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: com/alibaba/fastjson/support/spring/FastJsonHttpMessageConverter
      methodName: <init>
      methodDesc: null
      level: high
  Unzip:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: java/util/zip/ZipInputStream
      methodName: <init>
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: java/util/zip/ZipFile
      methodName: getInputStream
      methodDesc: null
      level: medium
    # Commons Compress 规则
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: org/apache/commons/compress/archivers/zip/ZipFile
      methodName: getInputStream
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: org/apache/commons/compress/archivers/zip/ZipArchiveInputStream
      methodName: getNextEntry
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: org/apache/commons/compress/archivers/zip/ZipArchiveInputStream
      methodName: getNextZipEntry
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: org/apache/commons/compress/archivers/tar/TarArchiveInputStream
      methodName: getNextEntry
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: org/apache/commons/compress/archivers/tar/TarArchiveInputStream
      methodName: getNextTarEntry
      methodDesc: null
      level: medium
    # zip4j 规则
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: net/lingala/zip4j/ZipFile
      methodName: extractAll
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: net/lingala/zip4j/ZipFile
      methodName: extractFile
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: net/lingala/zip4j/ZipFile
      methodName: getInputStream
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: net/lingala/zip4j/io/inputstream/ZipInputStream
      methodName: getNextEntry
      methodDesc: null
      level: medium
  Hessian.readObject:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: com/caucho/hessian/io/AbstractHessianInput
      methodName: readObject
      methodDesc: null
      level: high
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: com/caucho/hessian/io/HessianInput
      methodName: readObject
      methodDesc: null
      level: high
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: com/caucho/hessian/io/Hessian2Input
      methodName: readObject
      methodDesc: null
      level: high
  FreeMarker:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: freemarker/template/Template
      methodName: process
      methodDesc: null
      level: medium
  JEXL:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: org/apache/commons/jexl3/JexlExpression
      methodName: evaluate
      methodDesc: null
      level: high
  Rhino.eval:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: org/mozilla/javascript/Context
      methodName: evaluateString
      methodDesc: null
      level: medium
  Aviator.execute:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: com/googlecode/aviator/AviatorEvaluatorInstance
      methodName: execute
      methodDesc: null
      level: medium
  MVEL:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: org/mvel2/MVEL
      methodName: eval
      methodDesc: null
      level: high
  QLExpress:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: com/ql/util/express/ExpressRunner
      methodName: execute
      methodDesc: null
      level: high
  XStream:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: com/thoughtworks/xstream/XStream
      methodName: fromXML
      methodDesc: null
      level: high
  SQL.exec:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: java/sql/PreparedStatement
      methodName: execute
      methodDesc: null
      level: low
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: java/sql/PreparedStatement
      methodName: executeQuery
      methodDesc: null
      level: low
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: java/sql/PreparedStatement
      methodName: executeUpdate
      methodDesc: null
      level: low
  SQL.exec(no-prepare):
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: java/sql/Statement
      methodName: execute
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: java/sql/Statement
      methodName: executeQuery
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: java/sql/Statement
      methodName: executeUpdate
      methodDesc: null
      level: medium
  JDBC:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: java/sql/DriverManager
      methodName: getConnection
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: java/sql/DriverManager
      methodName: getDriver
      methodDesc: null
      level: medium
  XXE(all):
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: java/net/bull/javamelody/PayloadNameRequestWrapper
      methodName: getInputStream
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: javax/xml/bind/Unmarshaller
      methodName: unmarshal
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: javax/xml/parsers/DocumentBuilderFactory
      methodName: newDocumentBuilder
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: javax/xml/parsers/DocumentBuilder
      methodName: parse
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: javax/xml/parsers/SAXParser
      methodName: parse
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: javax/xml/stream/XMLStreamReader
      methodName: next
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: javax/xml/stream/XMLInputFactory
      methodName: createXMLStreamReader
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: javax/xml/transform/sax/SAXSource
      methodName: getInputSource
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: javax/xml/transform/sax/SAXTransformerFactory
      methodName: newTransformerHandler
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: javax/xml/transform/TransformerFactory
      methodName: newTransformer
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: javax/xml/validation/SchemaFactory
      methodName: newSchema
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: javax/xml/validation/Validator
      methodName: validate
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: javax/xml/xpath/XPathExpression
      methodName: evaluate
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: org/apache/commons/digester3/Digester
      methodName: parse
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: org/apache/ofbiz/base/util/UtilXml
      methodName: readXmlDocument
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: org/dom4j/io/SAXReader
      methodName: read
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: org/jdom/input/SAXBuilder
      methodName: build
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: org/jdom2/input/SAXBuilder
      methodName: build
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: org/xml/sax/helpers/XMLReaderFactory
      methodName: createXMLReader
      methodDesc: null
      level: medium
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: org/xml/sax/XMLReader
      methodName: parse
      methodDesc: null
      level: medium
  UserCustom1:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: UserCustom1
      methodName: test
      methodDesc: null
      level: low
  UserCustom2:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: UserCustom2
      methodName: test
      methodDesc: null
      level: low
  UserCustom3:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: UserCustom3
      methodName: test
      methodDesc: null
      level: low
  UserCustom4:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: UserCustom4
      methodName: test
      methodDesc: null
      level: low
  UserCustom5:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: UserCustom5
      methodName: test
      methodDesc: null
      level: low
  UserCustom6:
    - !!me.n1ar4.jar.analyzer.engine.SearchCondition
      className: UserCustom6
      methodName: test
      methodDesc: null
      level: low
